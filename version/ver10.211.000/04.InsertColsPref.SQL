INSERT INTO [COLSPREF] (USERID, TAB, COLSPREFTYPE, COL, COLWIDTH, SORT, SORTORDER, FILTEROPTIONS)

SELECT  

	fp.USERID ,
	fp.TAB, 
	0,
	fp.FINDERCOL ,
	fp.FINDERCOLWIDTH ,   
	CASE 
		WHEN fp.FINDERSORT is null THEN 0
		WHEN ISNUMERIC( fp.FINDERSORT) = 1 THEN cast(fp.FINDERSORT AS INT)
		ELSE 0 END FINDERSORT
	 ,   
	 case 
		WHEN fp.FINDERORDER is null THEN 0
		WHEN ISNUMERIC(fp.FINDERORDER) = 1 THEN 1 
		ELSE 0 END FINDERORDER,

	fp.FINDERFILTEROPTIONS 

FROM FINDERPREF fp
WHERE NOT EXISTS (

	SELECT 1 
	FROM 
	[COLSPREF] CP
	WHERE
			CP.[userid] = fp.userid
		AND cp.tab = fp.tab
		AND cp.COLSPREFTYPE = 0


)